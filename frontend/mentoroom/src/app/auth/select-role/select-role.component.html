<div class="animated-svg-background">
  <svg
    width="100%"
    height="100%"
    viewBox="0 0 100 100"
    xmlns="http://www.w3.org/2000/svg"
    preserveAspectRatio="xMidYMid slice"
  >
    <image
      xlink:href="/assets/hero-background.svg"
      width="100%"
      height="100%"
    />
  </svg>
  <div class="container">
    <p-card>
      <div class="card-container">
        <h1>WHO ARE YOU?</h1>
        <p>I am a...</p>
        <div class="role-container">
          <div
            class="role"
            [ngClass]="{
              selected: selectedRole === 'Student'
            }"
            (click)="selectRole('Student')"
          >
            <h2>Student</h2>
            <img src="../../../assets/role-student-image.svg" />
          </div>

          <div
            class="role"
            (click)="selectRole('Lecturer')"
            [ngClass]="{
              selected: selectedRole === 'Lecturer'
            }"
          >
            <h2>Lecturer</h2>
            <img src="../../../assets/role-lecturer-image.svg" alt="" />
          </div>
        </div>
        <p-button
          [disabled]="!selectedRole"
          [style]="{ padding: '16px 32px' }"
          (onClick)="showModal()"
          >Continue</p-button
        >
        <p-dialog
          (onHide)="onHide()"
          [draggable]="false"
          [modal]="true"
          [(visible)]="visible"
          [style]="{ padding: '4px' }"
        >
          <ng-template pTemplate="header">
            <span *ngIf="selectedRole === 'Lecturer'" class="p-dialog-title"
              >Enter access code</span
            >
            <span *ngIf="selectedRole === 'Student'" class="p-dialog-title"
              >Enter your index</span
            >
          </ng-template>

          <div *ngIf="selectedRole === 'Lecturer'" class="modal-wrapper">
            <p>
              To verify you as a lecturer you must provide an access code.
              <br />
              If you do not have an access code, please contact the
              administrator
            </p>
            <p-inputOtp
              (onChange)="codeChanged()"
              [length]="9"
              style="gap: 0"
              id="codeInput"
              [(ngModel)]="code"
            >
              <ng-template
                pTemplate="input"
                let-token
                let-events="events"
                let-index="index"
              >
                <input
                  pInputText
                  type="text"
                  [maxLength]="1"
                  (paste)="onPaste($event)"
                  (input)="events.input($event)"
                  (keydown)="events.keydown($event)"
                  [attr.value]="token"
                  class="custom-otp-input"
                />
                <div *ngIf="index === 3" class="otp-separator">
                  <i class="pi pi-minus"></i>
                </div>

                <div *ngIf="index === 6" class="otp-separator">
                  <i class="pi pi-minus"></i>
                </div>
              </ng-template>
            </p-inputOtp>

            <app-loading-spinner *ngIf="isLoading"></app-loading-spinner>
            <p
              *ngIf="errorMessage !== null"
              style="color: var(--invalid); font-weight: 400"
            >
              {{ errorMessage }}
            </p>

            <div>
              <p-button (onClick)="hideModal()" [link]="true">Cancel</p-button>
              <p-button [disabled]="buttonDisabled" (onClick)="onContinue()"
                >Continue</p-button
              >
            </div>
          </div>
          <div *ngIf="selectedRole === 'Student'" class="modal-wrapper">
            <p>Enter your student index to move on</p>
            <span class="p-input-icon-left">
              <i class="pi pi-user"></i>
              <input
                placeholder="Enter student index number"
                [style]="{ width: '100%' }"
                [inputStyle]="{ width: '100%' }"
                type="text"
                pInputText
                [(ngModel)]="studentIndex"
              />
            </span>

            <app-loading-spinner *ngIf="isLoading"></app-loading-spinner>
            <p
              *ngIf="errorMessage !== null"
              style="color: var(--invalid); font-weight: 400"
            >
              {{ errorMessage }}
            </p>

            <div>
              <p-button (onClick)="hideModal()" [link]="true">Cancel</p-button>
              <p-button [disabled]="!studentIndex" (onClick)="onContinue()"
                >Continue</p-button
              >
            </div>
          </div>
        </p-dialog>
      </div>
    </p-card>
  </div>
</div>
